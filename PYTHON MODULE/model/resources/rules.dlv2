% testing
%  edge(0,1,1). edge(0,18,0). edge(0,32,1). edge(1,0,1). edge(1,2,0). edge(2,1,0). edge(2,18,1). edge(2,56,0). edge(3,5,0). edge(3,18,0). edge(3,44,1). edge(3,56,1). edge(4,20,1). edge(4,21,1). edge(4,45,0). edge(4,54,0). edge(5,3,0). edge(5,35,1). edge(5,36,1). edge(5,39,0). edge(6,8,0). edge(6,20,0). edge(6,45,1). edge(6,57,1). edge(7,21,0). edge(7,24,0). edge(7,35,1). edge(7,45,1). edge(8,6,0). edge(8,23,1). edge(8,26,0). edge(8,38,1). edge(9,24,1). edge(9,35,0). edge(9,39,1). edge(9,70,0). edge(10,25,1). edge(10,36,0). edge(10,39,1). edge(10,49,0). edge(11,13,0). edge(11,25,0). edge(11,49,1). edge(12,48,0). edge(12,62,1). edge(12,63,1). edge(12,65,0). edge(13,11,0). edge(13,63,1). edge(14,15,0). edge(14,61,0). edge(14,64,1). edge(14,71,1). edge(15,14,0). edge(15,16,1). edge(15,51,1). edge(16,15,1). edge(16,42,1). edge(16,43,1). edge(16,64,0). edge(17,52,1). edge(17,67,0). edge(18,0,0). edge(18,2,1). edge(18,3,0). edge(18,34,1). edge(19,55,1). edge(19,69,0). edge(20,4,1). edge(20,6,0). edge(20,33,0). edge(20,55,1). edge(21,4,1). edge(21,7,0). edge(21,44,1). edge(21,66,0). edge(21,68,0). edge(22,46,0). edge(22,56,1). edge(23,8,1). edge(23,24,1). edge(23,45,0). edge(23,47,0). edge(24,7,0). edge(24,9,1). edge(24,23,1). edge(24,40,0). edge(25,10,1). edge(25,11,0). edge(25,46,0). edge(26,8,0). edge(26,47,1). edge(26,59,1). edge(26,61,0). edge(27,59,0). edge(27,60,1). edge(27,61,1). edge(27,71,0). edge(28,42,0). edge(28,43,0). edge(28,50,0). edge(28,64,1). edge(28,72,1). edge(29,30,1). edge(29,65,0). edge(29,74,1). edge(30,29,1). edge(30,73,0). edge(31,32,1). edge(31,53,1). edge(31,66,0). edge(31,68,0). edge(32,0,1). edge(32,31,1). edge(32,34,0). edge(33,20,0). edge(33,52,0). edge(33,54,1). edge(33,67,1). edge(34,18,1). edge(34,32,0). edge(34,44,0). edge(34,66,1). edge(34,68,1). edge(35,5,1). edge(35,7,1). edge(35,9,0). edge(35,44,0). edge(36,5,1). edge(36,10,0). edge(36,46,1). edge(36,56,0). edge(37,38,1). edge(37,58,0). edge(37,69,0). edge(38,8,1). edge(38,37,1). edge(38,57,0). edge(38,59,0). edge(39,5,0). edge(39,9,1). edge(39,10,1). edge(39,48,0). edge(40,24,0). edge(40,47,1). edge(40,50,0). edge(40,70,1). edge(41,47,0). edge(41,50,1). edge(41,61,1). edge(41,64,0). edge(42,16,1). edge(42,28,0). edge(42,43,0). edge(42,74,1). edge(43,16,1). edge(43,28,0). edge(43,42,0). edge(43,74,1). edge(44,3,1). edge(44,21,1). edge(44,34,0). edge(44,35,0). edge(45,4,0). edge(45,6,1). edge(45,7,1). edge(45,23,0). edge(46,22,0). edge(46,25,0). edge(46,36,1). edge(47,23,0). edge(47,26,1). edge(47,40,1). edge(47,41,0). edge(48,12,0). edge(48,39,0). edge(48,49,1). edge(48,70,1). edge(49,10,0). edge(49,11,1). edge(49,48,1). edge(49,63,0). edge(50,28,0). edge(50,40,0). edge(50,41,1). edge(50,62,1). edge(51,15,1). edge(51,71,0). edge(52,17,1). edge(52,33,0). edge(52,53,1). edge(53,31,1). edge(53,52,1). edge(53,54,0). edge(54,4,0). edge(54,33,1). edge(54,53,0). edge(54,66,1). edge(54,68,1). edge(55,19,1). edge(55,20,1). edge(55,57,0). edge(55,67,0). edge(56,2,0). edge(56,3,1). edge(56,22,1). edge(56,36,0). edge(57,6,1). edge(57,38,0). edge(57,55,0). edge(57,69,1). edge(58,37,0). edge(58,59,1). edge(58,60,0). edge(59,26,1). edge(59,27,0). edge(59,38,0). edge(59,58,1). edge(60,27,1). edge(60,58,0). edge(61,14,0). edge(61,26,0). edge(61,27,1). edge(61,41,1). edge(62,12,1). edge(62,50,1). edge(62,70,0). edge(62,72,0). edge(63,12,1). edge(63,13,1). edge(63,49,0). edge(63,73,0). edge(64,14,1). edge(64,16,0). edge(64,28,1). edge(64,41,0). edge(65,12,0). edge(65,29,0). edge(65,72,1). edge(65,73,1). edge(66,21,0). edge(66,31,0). edge(66,34,1). edge(66,54,1). edge(66,68,0). edge(67,17,0). edge(67,33,1). edge(67,55,0). edge(68,21,0). edge(68,31,0). edge(68,34,1). edge(68,54,1). edge(68,66,0). edge(69,19,0). edge(69,37,0). edge(69,57,1). edge(70,9,0). edge(70,40,1). edge(70,48,1). edge(70,62,0). edge(71,14,1). edge(71,27,0). edge(71,51,0). edge(72,28,1). edge(72,62,0). edge(72,65,1). edge(72,74,0). edge(73,30,0). edge(73,63,0). edge(73,65,1). edge(74,29,1). edge(74,42,1). edge(74,43,1). edge(74,72,0). noConsider(34). noConsider(68). noConsider(35). noConsider(44). noConsider(5). noConsider(36). noConsider(10). noConsider(39). noConsider(7). noConsider(24). noConsider(6). noConsider(45). noConsider(40). noConsider(47). noConsider(22). noConsider(46). noConsider(62). noConsider(70). noConsider(26). noConsider(61). noConsider(4). noConsider(20). noConsider(2). noConsider(56). noConsider(31). noConsider(53). noConsider(3). noConsider(18). noConsider(8). noConsider(23). noConsider(11). noConsider(25). noConsider(15). noConsider(51). noConsider(16). noConsider(43). noConsider(17). noConsider(52). noConsider(0). noConsider(32). noConsider(27). noConsider(60). noConsider(65). noConsider(72). noConsider(63). noConsider(73). noConsider(37). noConsider(69). noConsider(19). noConsider(55). noConsider(12). noConsider(48). noConsider(41). noConsider(50). noConsider(28). noConsider(42). noConsider(38). noConsider(57). noConsider(33). noConsider(54). noConsider(14). noConsider(64). noConsider(21). noConsider(66). noConsider(29). noConsider(74).
%   node(0,0). node(1,0). node(2,0). node(3,0). node(4,0). node(5,0). node(6,0). node(7,0). node(8,0). node(9,0). node(10,0). node(11,0). node(12,0). node(13,0). node(14,0). node(15,0). node(16,0). node(17,1). node(18,1). node(19,1). node(20,1). node(21,1). node(22,1). node(23,1). node(24,1). node(25,1). node(26,1). node(27,1). node(28,1). node(29,1). node(30,1). node(31,5). node(32,5). node(33,5). node(34,5). node(35,5). node(36,5). node(37,5). node(38,5). node(39,5). node(40,5). node(41,5). node(42,5). node(43,5). node(44,2). node(45,2). node(46,2). node(47,2). node(48,2). node(49,2). node(50,2). node(51,2). node(52,3). node(53,3). node(54,3). node(55,3). node(56,3). node(57,3). node(58,3). node(59,3). node(60,3). node(61,3). node(62,3). node(63,3). node(64,3). node(65,3). node(66,4). node(67,4). node(68,4). node(69,4). node(70,4). node(71,4). node(72,4). node(73,4). node(74,4).

%#show swap/2.
%#show adjacentNodes/2.

% make graph not oriented
edge(Y, X, P) :- edge(X, Y, P).

%  g&c
swap(ID1, ID2) | notSwap(ID1, ID2) :- node(ID1, _), node(ID2, _), ID1<ID2.
swap(ID2, ID1) :- swap(ID1, ID2).

% exchange node`s edges
exchangedEdge(ID1, ID3, P) :- edge(ID2, ID3, P), swap(ID1, ID2), ID1!=ID3, node(ID1, T), node(ID3, T).
deletedEdge(ID2, ID3) :- edge(ID2, ID3, P), swap(ID1, ID2).

% at least 3 adjacent
atLeast3Adjacent(ID1, ID3, P) :- exchangedEdge(ID1, ID2, P), exchangedEdge(ID1, ID3, P), ID2!=ID3.
atLeast3Adjacent(ID1, ID3, P) :- exchangedEdge(ID1, ID2, P), edge(ID2, ID3, P), ID1!=ID3, node(ID2, T), node(ID3, T), not deletedEdge(ID2, ID3).
atLeast3Adjacent(ID1, ID3, P) :- atLeast3Adjacent(ID1, ID2, P), edge(ID2, ID3, P), ID1!=ID3, node(ID2, T), node(ID3, T), not deletedEdge(ID2, ID3).

% they can be not adjacent if > 3
al3d(ID1, ID3) :- atLeast3Adjacent(ID1, ID3, _).
notOnlyAdj(ID1, ID3) :- exchangedEdge(ID1, ID2, _), edge(ID2, ID3, _), node(ID2, T), node(ID3, T), ID1!=ID3, not deletedEdge(ID2, ID3), not al3d(ID1,ID3).
notOnlyAdj(ID1, ID3) :- notOnlyAdj(ID1, ID2, _), edge(ID2, ID3, _), node(ID2, T), node(ID3, T), ID1!=ID3, not deletedEdge(ID2, ID3), not al3d(ID1,ID3).


% only a single swap
:- #count{ID1, ID2 : swap(ID1, ID2)} != 2.
:- swap(ID1, ID2), not swap(ID2, ID1).

% can t swap between not adjacent nodes
edgeWithoutPosition(ID1,ID2) :- edge(ID1,ID2, _).

:- swap(ID1, ID2), not edgeWithoutPosition(ID1,ID2).

% can t swap between nodes with the same candy type
:- swap(ID1, ID2), node(ID1, T), node(ID2, T).


% at least 3 nodes on the same position
:- #count{ID1, ID3, P : atLeast3Adjacent(ID1, ID3, P)} == 0.

% weak
adjacentNodes(ID) :- atLeast3Adjacent(ID, _, _).
adjacentNodes(ID) :- atLeast3Adjacent(_, ID, _).
adjacentNodes(ID) :- notOnlyAdj(ID, _).
adjacentNodes(ID) :- notOnlyAdj(_, ID).
adjacentNodes(ID) :- exchangedEdge(ID, _).
adjacentNodes(ID) :- exchangedEdge(_, ID).

nodesWithDifferentType(ID) :- node(ID, _), not adjacentNodes(ID).
:~ nodesWithDifferentType(ID). [1@1, ID]
